/*
*  Project: Iconomatic
*  Description: Detect links to native files and append the proper icon image after the link
*  Author: Michael Oakley
*  License: MIT
*/
;(function(e,t,n,r){"use strict";function a(t,n){this.element=t;this.options=e.extend({},u,n);this._defaults=u;this._name=o;this.init()}var i="//www.nrel.gov/images/";var s={avi:{path:i+"icon_video.gif",type:"Video"},doc:{path:i+"icon_word.gif",type:"Microsoft Word"},docx:{path:i+"icon_word.gif",type:"Microsoft Word"},gif:{path:i+"icon_image.gif",type:"GIF"},jpg:{path:i+"icon_image.gif",type:"JPG"},m3u:{path:i+"icon_audio.gif",type:"Audio"},mov:{path:i+"icon_video.gif",type:"Video"},mp3:{path:i+"icon_audio.gif",type:"Audio"},mpg:{path:i+"icon_video.gif",type:"Video"},mpeg:{path:i+"icon_video.gif",type:"Video"},pdf:{path:i+"icon_pdf.gif",type:"PDF"},ppt:{path:i+"icon_powerpoint.gif",type:"Microsoft PowerPoint"},pptx:{path:i+"icon_powerpoint.gif",type:"Microsoft PowerPoint"},wmv:{path:i+"icon_video.gif",type:"Video"},xls:{path:i+"icon_excel.gif",type:"Microsoft Excel"},xlsx:{path:i+"icon_excel.gif",type:"Microsoft Excel"},xlsm:{path:i+"icon_excel.gif",type:"Microsoft Excel"},zip:{path:i+"icon_zip.gif",type:"ZIP Archive"}};var o="iconomatic";var u={ajax:false,dataMode:false,dataAttr:"iconomatic",iconClass:"fileIcon",filesObj:s};a.prototype={init:function(){var t,n;n=e("body");t=this.getLinks(n);this.addIcons(t);if(this.options.ajax){this.enableAjax()}},getLinks:function(t){var n,r,i,s;n=this.options;r=n.filesObj;i="data-"+n.dataAttr;s=[];e(t).find("a").filter(function(){return!e(this).attr("data-iconomatic-tagged")}).each(function(t,o){var u,a;u=e(o).attr("href");if(typeof u!=="undefined"&&u!==null&&u!==""){a=u.toLowerCase().split(".").splice(-1,1).toString();if(a in r){e(o).attr("data-iconomatic-tagged",a);s.push(o)}}if(n.dataMode){if(e(o).attr(i)){e(o).attr("data-iconomatic-tagged",function(){return e(this).attr(i)});s.push(o)}}});return s},enableAjax:function(){var e,r,i,s,o=this;if(t.MutationObserver||t.WebKitMutationObserver||t.MozMutationObserver){r=t.MutationObserver||t.WebKitMutationObserver||t.MozMutationObserver}else{return true}i=n.querySelector("body");s=new r(function(t){t.forEach(function(t){if(t.type==="childList"){e=o.getLinks(t.target);o.addIcons(e)}})});s.observe(i,{childList:true,subtree:true})},addIcons:function(t){var n=this.options;e(t).each(function(t,r){var i,s,o;i=e(r).data("iconomatic-tagged");s=typeof n.filesObj[i]!=="undefined"?n.filesObj[i].path:false;if(s){o={"class":n.iconClass,alt:n.filesObj[i].type,src:s};e("<img />",o).appendTo(r)}})}};e.fn[o]=function(t){return this.each(function(){if(!e.data(this,"plugin_"+o)){e.data(this,"plugin_"+o,new a(this,t))}})}})(jQuery,window,document)